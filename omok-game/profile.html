<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>내 전적 - 오목 게임</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
</head>
<body class="bg-light">
    <!-- 상단 네비게이션 -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="game.html">오목 게임</a>
            <div class="navbar-nav ms-auto">
                <span class="navbar-text me-3" id="userInfo">로딩중...</span>
                <a class="nav-link" href="game.html">게임하기</a>
                <button class="btn btn-outline-light btn-sm" onclick="Auth.logout()">로그아웃</button>
            </div>
        </div>
    </nav>

    <!-- 메인 컨테이너 -->
    <div class="container mt-4">
        <!-- 프로필 헤더 -->
        <div class="profile-header text-center">
            <div class="container py-4">
                <h1 class="display-5 fw-bold" id="profileUsername">사용자명</h1>
                <p class="lead" id="profileJoinDate">가입일: 로딩중...</p>
            </div>
        </div>

        <!-- 통계 카드들 -->
        <div class="row mb-4">
            <div class="col-md-3 col-sm-6">
                <div class="card stats-card">
                    <div class="card-body">
                        <div class="stats-number" id="totalGames">-</div>
                        <div class="stats-label">총 경기</div>
                    </div>
                </div>
            </div>
            <div class="col-md-3 col-sm-6">
                <div class="card stats-card">
                    <div class="card-body">
                        <div class="stats-number text-success" id="totalWins">-</div>
                        <div class="stats-label">승리</div>
                    </div>
                </div>
            </div>
            <div class="col-md-3 col-sm-6">
                <div class="card stats-card">
                    <div class="card-body">
                        <div class="stats-number text-danger" id="totalLosses">-</div>
                        <div class="stats-label">패배</div>
                    </div>
                </div>
            </div>
            <div class="col-md-3 col-sm-6">
                <div class="card stats-card">
                    <div class="card-body">
                        <div class="stats-number text-warning" id="winRate">-</div>
                        <div class="stats-label">승률</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 경기 전적 -->
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">최근 경기 전적</h5>
            </div>
            <div class="card-body">
                <!-- 로딩 상태 -->
                <div id="matchHistoryLoading" class="text-center py-4">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">로딩중...</span>
                    </div>
                    <p class="mt-2">전적을 불러오는 중...</p>
                </div>

                <!-- 전적이 없을 때 -->
                <div id="noMatchHistory" class="text-center py-4 d-none">
                    <p class="text-muted">아직 플레이한 게임이 없습니다.</p>
                    <a href="game.html" class="btn btn-primary">첫 게임 시작하기</a>
                </div>

                <!-- 전적 테이블 -->
                <div id="matchHistoryTable" class="d-none">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>날짜</th>
                                    <th>상대방</th>
                                    <th>결과</th>
                                    <th>게임 시간</th>
                                </tr>
                            </thead>
                            <tbody id="matchHistoryBody">
                                <!-- 동적으로 생성 -->
                            </tbody>
                        </table>
                    </div>

                    <!-- 더 보기 버튼 -->
                    <div class="text-center mt-3">
                        <button id="loadMoreBtn" class="btn btn-outline-primary d-none">더 보기</button>
                    </div>
                </div>

                <!-- 에러 메시지 -->
                <div id="matchHistoryError" class="alert alert-danger d-none" role="alert">
                    전적을 불러오는 중 오류가 발생했습니다. 페이지를 새로고침해주세요.
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- 프로필 관련 JS -->
    <script src="js/api.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/profile.js"></script>
    
    <script>
        // 페이지 로드 시 프로필 초기화
        document.addEventListener('DOMContentLoaded', function() {
            Profile.init();
        });
    </script>
</body>
</html>